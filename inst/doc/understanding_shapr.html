<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Camilla Lingjærde, Martin Jullum &amp; Nikolai Sellereite" />


<title>shapr: Explaining individual machine learning predictions with Shapley values</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore"><code>shapr</code>: Explaining individual
machine learning predictions with Shapley values</h1>
<h4 class="author">Camilla Lingjærde, Martin Jullum &amp; Nikolai
Sellereite</h4>



<blockquote>
<p><a href="#intro">Introduction</a></p>
</blockquote>
<blockquote>
<p><a href="#overview">Overview of Package</a></p>
</blockquote>
<blockquote>
<p><a href="#KSHAP">The Kernel SHAP Method</a></p>
</blockquote>
<blockquote>
<p><a href="#ex">Examples</a></p>
</blockquote>
<blockquote>
<p><a href="#advanced">Advanced usage</a></p>
</blockquote>
<blockquote>
<p><a href="#compare">Comparison to Lundberg &amp; Lee’s
implementation</a></p>
</blockquote>
<p><a id="intro"></a></p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>shapr</code> package implements an extended version of the
Kernel SHAP method for approximating Shapley values (<span class="citation">Lundberg and Lee (2017)</span>), in which dependence
between the features is taken into account (<span class="citation">Aas,
Jullum, and Løland (2019)</span>). Estimation of Shapley values is of
interest when attempting to explain complex machine learning models. Of
existing work on interpreting individual predictions, Shapley values is
regarded to be the only model-agnostic explanation method with a solid
theoretical foundation (<span class="citation">Lundberg and Lee
(2017)</span>). Kernel SHAP is a computationally efficient approximation
to Shapley values in higher dimensions, but it assumes independent
features. <span class="citation">Aas, Jullum, and Løland (2019)</span>
extend the Kernel SHAP method to handle dependent features, resulting in
more accurate approximations to the true Shapley values. See the <a href="https://arxiv.org/abs/1903.10464">paper</a> (<span class="citation">Aas, Jullum, and Løland (2019)</span>) for further
details.</p>
<p><a id="overview"></a></p>
<p><br></p>
</div>
<div id="overview-of-package" class="section level1">
<h1>Overview of Package</h1>
<div id="functions" class="section level2">
<h2>Functions</h2>
<p>Here is an overview of the main functions. You can read their
documentation and see examples with <code>?function_name</code>.</p>
<table>
<caption>Main functions in the <code>shapr</code> package.</caption>
<colgroup>
<col width="35%" />
<col width="64%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>shapr</code></td>
<td align="left">Get Shapley weights for test data.</td>
</tr>
<tr class="even">
<td align="left"><code>explain</code></td>
<td align="left">Computes kernel SHAP values for test data.</td>
</tr>
<tr class="odd">
<td align="left"><code>plot.shapr</code></td>
<td align="left">Plots the individual prediction explanations. Uses
facet_wrap of ggplot.</td>
</tr>
</tbody>
</table>
<p><a id="KSHAP"></a></p>
<p><br></p>
</div>
</div>
<div id="the-kernel-shap-method" class="section level1">
<h1>The Kernel SHAP Method</h1>
<p>Assume a predictive model <span class="math inline">\(f(\boldsymbol{x})\)</span> for a response value
<span class="math inline">\(y\)</span> with features <span class="math inline">\(\boldsymbol{x}\in \mathbb{R}^M\)</span>, trained
on a training set, and that we want to explain the predictions for new
sets of data. This may be done using ideas from cooperative game theory,
letting a single prediction take the place of the game being played and
the features the place of the players. Letting <span class="math inline">\(N\)</span> denote the set of all <span class="math inline">\(M\)</span> players, and <span class="math inline">\(S \subseteq N\)</span> be a subset of <span class="math inline">\(|S|\)</span> players, the “contribution” function
<span class="math inline">\(v(S)\)</span> describes the total expected
sum of payoffs the members of <span class="math inline">\(S\)</span> can
obtain by cooperation. The Shapley value (<span class="citation">Shapley
(1953)</span>) is one way to distribute the total gains to the players,
assuming that they all collaborate. The amount that player <span class="math inline">\(i\)</span> gets is then</p>
<p><span class="math display">\[\phi_i(v) = \phi_i = \sum_{S \subseteq N
\setminus\{i\}} \frac{|S| ! (M-| S| - 1)!}{M!}(v(S\cup
\{i\})-v(S)),\]</span></p>
<p>that is, a weighted mean over all subsets <span class="math inline">\(S\)</span> of players not containing player <span class="math inline">\(i\)</span>. <span class="citation">Lundberg and
Lee (2017)</span> define the contribution function for a certain subset
<span class="math inline">\(S\)</span> of these features <span class="math inline">\(\boldsymbol{x}_S\)</span> as <span class="math inline">\(v(S) =
\mbox{E}[f(\boldsymbol{x})|\boldsymbol{x}_S]\)</span>, the expected
output of the predictive model conditional on the feature values of the
subset. <span class="citation">Lundberg and Lee (2017)</span> names this
type of Shapley values SHAP (SHapley Additive exPlanation) values. Since
the conditional expectations can be written as</p>
<p><span class="math display">\[\begin{equation}
\label{eq:CondExp}
E[f(\boldsymbol{x})|\boldsymbol{x}_s=\boldsymbol{x}_S^*] =
E[f(\boldsymbol{x}_{\bar{S}},\boldsymbol{x}_S)|\boldsymbol{x}_S=\boldsymbol{x}_S^*]
=
\int
f(\boldsymbol{x}_{\bar{S}},\boldsymbol{x}_S^*)\,p(\boldsymbol{x}_{\bar{S}}|\boldsymbol{x}_S=\boldsymbol{x}_S^*)d\boldsymbol{x}_{\bar{S}},
\end{equation}\]</span></p>
<p>the conditional distributions <span class="math inline">\(p(\boldsymbol{x}_{\bar{S}}|\boldsymbol{x}_S=\boldsymbol{x}_S^*)\)</span>
are needed to compute the contributions. The Kernel SHAP method of <span class="citation">Lundberg and Lee (2017)</span> assumes feature
independence, so that <span class="math inline">\(p(\boldsymbol{x}_{\bar{S}}|\boldsymbol{x}_S=\boldsymbol{x}_S^*)=p(\boldsymbol{x}_{\bar{S}})\)</span>.
If samples <span class="math inline">\(\boldsymbol{x}_{\bar{S}}^{k},
k=1,\ldots,K\)</span>, from <span class="math inline">\(p(\boldsymbol{x}_{\bar{S}}|\boldsymbol{x}_S=\boldsymbol{x}_S^*)\)</span>
are available, the conditional expectation in above can be approximated
by</p>
<p><span class="math display">\[\begin{equation}
  v_{\text{KerSHAP}}(S) = \frac{1}{K}\sum_{k=1}^K
f(\boldsymbol{x}_{\bar{S}}^{k},\boldsymbol{x}_S^*).
\end{equation}\]</span></p>
<p>In Kernel SHAP, <span class="math inline">\(\boldsymbol{x}_{\bar{S}}^{k},
k=1,\ldots,K\)</span> are sampled from the <span class="math inline">\(\bar{S}\)</span>-part of the training data,
<em>independently</em> of <span class="math inline">\(\boldsymbol{x}_{S}\)</span>. This is motivated by
using the training set as the empirical distribution of <span class="math inline">\(\boldsymbol{x}_{\bar{S}}\)</span>, and assuming
that <span class="math inline">\(\boldsymbol{x}_{\bar{S}}\)</span> is
independent of <span class="math inline">\(\boldsymbol{x}_S=\boldsymbol{x}_S^*\)</span>. Due
to the independence assumption, if the features in a given model are
highly dependent, the Kernel SHAP method may give a completely wrong
answer. This can be avoided by estimating the conditional distribution
<span class="math inline">\(p(\boldsymbol{x}_{\bar{S}}|\boldsymbol{x}_S=\boldsymbol{x}_S^*)\)</span>
directly and generating samples from this distribution. With this small
change, the contributions and Shapley values may then be approximated as
in the ordinary Kernel SHAP framework. <span class="citation">Aas,
Jullum, and Løland (2019)</span> propose three different approaches for
estimating the conditional probabilities. The methods may also be
combined, such that e.g. one method is used when conditioning on a small
number of features, while another method is used otherwise.</p>
<p><a id="gaussian"></a></p>
<div id="multivariate-gaussian-distribution-approach" class="section level2">
<h2>Multivariate Gaussian Distribution Approach</h2>
<p>The first approach arises from the assumption that the feature vector
<span class="math inline">\(\boldsymbol{x}\)</span> stems from a
multivariate Gaussian distribution with some mean vector <span class="math inline">\(\boldsymbol{\mu}\)</span> and covariance matrix
<span class="math inline">\(\boldsymbol{\Sigma}\)</span>. Under this
assumption, the conditional distribution <span class="math inline">\(p(\boldsymbol{x}_{\bar{\mathcal{S}}}
|\boldsymbol{x}_{\mathcal{S}}=\boldsymbol{x}_{\mathcal{S}}^*)\)</span>
is also multivariate Gaussian<br />
<span class="math inline">\(\text{N}_{|\bar{\mathcal{S}}|}(\boldsymbol{\mu}_{\bar{\mathcal{S}}|\mathcal{S}},\boldsymbol{\Sigma}_{\bar{\mathcal{S}}|\mathcal{S}})\)</span>,
with analytical expressions for the conditional mean vector <span class="math inline">\(\boldsymbol{\mu}_{\bar{\mathcal{S}}|\mathcal{S}}\)</span>
and covariance matrix <span class="math inline">\(\boldsymbol{\Sigma}_{\bar{\mathcal{S}}|\mathcal{S}}\)</span>,
see <span class="citation">Aas, Jullum, and Løland (2019)</span> for
details. Hence, instead of sampling from the marginal empirical
distribution of <span class="math inline">\(\boldsymbol{x}_{\bar{\mathcal{S}}}\)</span>
approximated by the training data, we can sample from the Gaussian
conditional distribution, which is fitted using the training data. Using
the resulting samples <span class="math inline">\(\boldsymbol{x}_{\bar{\mathcal{S}}}^k,
k=1,\ldots,K\)</span>, the conditional expectations be approximated as
in the Kernel SHAP.</p>
<p><a id="copula"></a></p>
</div>
<div id="gaussian-copula-approach" class="section level2">
<h2>Gaussian Copula Approach</h2>
<p>If the features are far from multivariate Gaussian, an alternative
approach is to instead represent the marginals by their empirical
distributions, and model the dependence structure by a Gaussian copula.
Assuming a Gaussian copula, we may convert the marginals of the training
data to Gaussian features using their empirical distributions, and then
fit a multivariate Gaussian distribution to these.</p>
<p>To produce samples from the conditional distribution <span class="math inline">\(p(\boldsymbol{x}_{\bar{\mathcal{S}}}
|\boldsymbol{x}_{\mathcal{S}}=\boldsymbol{x}_{\mathcal{S}}^*)\)</span>,
we convert the marginals of <span class="math inline">\(\boldsymbol{x}_{\mathcal{S}}\)</span> to
Gaussians, sample from the conditional Gaussian distribution as above,
and convert the marginals of the samples back to the original
distribution. Those samples are then used to approximate the sample from
the resulting multivariate Gaussian conditional distribution. While
other copulas may be used, the Gaussian copula has the benefit that we
may use the analytical expressions for the conditionals <span class="math inline">\(\boldsymbol{\mu}_{\bar{\mathcal{S}}|\mathcal{S}}\)</span>
and <span class="math inline">\(\boldsymbol{\Sigma}_{\bar{\mathcal{S}}|\mathcal{S}}\)</span>.
Finally, we may convert the marginals back to their original
distribution, and use the resulting samples to approximate the
conditional expectations as in the Kernel SHAP.</p>
<p><a id="empirical"></a></p>
</div>
<div id="empirical-conditional-distribution-approach" class="section level2">
<h2>Empirical Conditional Distribution Approach</h2>
<p>If both the dependence structure and the marginal distributions of
<span class="math inline">\(\boldsymbol{x}\)</span> are very far from
the Gaussian, neither of the two aforementioned methods will work very
well. Few methods exists for the non-parametric estimation of
conditional densities, and the classic kernel estimator (<span class="citation">Rosenblatt (1956)</span>) for non-parametric density
estimation suffers greatly from the curse of dimensionality and does not
provide a way to generate samples from the estimated distribution. For
such situations, <span class="citation">Aas, Jullum, and Løland
(2019)</span> propose an empirical conditional approach to sample
approximately from <span class="math inline">\(p(\boldsymbol{x}_{\bar{\mathcal{S}}}|\boldsymbol{x}_{\mathcal{S}}^*)\)</span>.
The idea is to compute weights <span class="math inline">\(w_{\mathcal{S}}(\boldsymbol{x}^*,\boldsymbol{x}^i),\
i=1,...,n_{\text{train}}\)</span> for all training instances based on
their Mahalanobis distances (in the <span class="math inline">\(S\)</span> subset only) to the instance <span class="math inline">\(\boldsymbol{x}^*\)</span> to be explained. Instead
of sampling from this weighted (conditional) empirical distribution,
<span class="citation">Aas, Jullum, and Løland (2019)</span> suggests a
more efficient variant, using only the <span class="math inline">\(K\)</span> instances with the largest weights:</p>
<p><span class="math display">\[v_{\text{condKerSHAP}}(\mathcal{S}) =
\frac{\sum_{k=1}^K w_{\mathcal{S}}(\boldsymbol{x}^*,
\boldsymbol{x}^{[k]}) f(\boldsymbol{x}_{\bar{\mathcal{S}}}^{[k]},
\boldsymbol{x}_{\mathcal{S}}^*)}{\sum_{k=1}^K
w_{\mathcal{S}}(\boldsymbol{x}^*,\boldsymbol{x}^{[k]})},\]</span></p>
<p>The number of samples <span class="math inline">\(K\)</span> to be
used in the approximate prediction can for instance be chosen such that
the <span class="math inline">\(K\)</span> largest weights accounts for
a fraction <span class="math inline">\(\eta\)</span>, for example <span class="math inline">\(0.9\)</span>, of the total weight. If <span class="math inline">\(K\)</span> exceeds a certain limit, for instance
<span class="math inline">\(5,000\)</span>, it might be set to that
limit. A bandwidth parameter <span class="math inline">\(\sigma\)</span>
used to scale the weights, must also be specified. This choice may be
viewed as a bias-variance trade-off. A small <span class="math inline">\(\sigma\)</span> puts most of the weight to a few
of the closest training observations and thereby gives low bias, but
high variance. When <span class="math inline">\(\sigma \rightarrow
\infty\)</span>, this method converges to the original Kernel SHAP
assuming feature independence. Typically, when the features are highly
dependent, a small <span class="math inline">\(\sigma\)</span> is
typically needed such that the bias does not dominate. <span class="citation">Aas, Jullum, and Løland (2019)</span> show that a
proper criterion for selecting <span class="math inline">\(\sigma\)</span> is a small-sample-size corrected
version of the AIC known as AICc. As calculation of it is
computationally intensive, an approximate version of the selection
criterion is also suggested. Details on this is found in <span class="citation">Aas, Jullum, and Løland (2019)</span>.</p>
<p><a id="ex"></a></p>
<p><br></p>
</div>
<div id="conditional-inference-tree-approach" class="section level2">
<h2>Conditional Inference Tree Approach</h2>
<p>The previous three methods can only handle numerical data. This means
that if the data contains categorical/discrete/ordinal features, the
features first have to be one-hot encoded. When the number of
levels/features is large, this is not feasible. An approach that handles
mixed (i.e numerical, categorical, discrete, ordinal) features and both
univariate and multivariate responses is conditional inference trees
(<span class="citation">Hothorn, Hornik, and Zeileis (2006)</span>).</p>
<p>Conditional inference trees is a special tree fitting procedure that
relies on hypothesis tests to choose both the splitting feature and the
splitting point. The tree fitting procedure is sequential: first a
splitting feature is chosen (the feature that is least independent of
the response), and then a splitting point is chosen for this feature.
This decreases the chance of being biased towards features with many
splits (<span class="citation">Hothorn, Hornik, and Zeileis
(2006)</span>).</p>
<p>We use conditional inference trees (<em>ctree</em>) to model the
conditional distribution, <span class="math inline">\(p(\boldsymbol{x}_{\bar{\mathcal{S}}}|\boldsymbol{x}_{\mathcal{S}}^*)\)</span>,
found in the Shapley methodology. First, we fit a different conditional
inference tree to each conditional distribution. Once a tree is fit for
given dependent features, the end node of <span class="math inline">\(\boldsymbol{x}_{\mathcal{S}}^*\)</span> is found.
Then, we sample from this end node and use the resulting samples, <span class="math inline">\(\boldsymbol{x}_{\bar{\mathcal{S}}}^k,
k=1,\ldots,K\)</span>, when approximating the conditional expectations
as in Kernel SHAP. See <span class="citation">Redelmeier, Jullum, and
Aas (2020)</span> for more details.</p>
<p>The conditional inference trees are fit using the <em>party</em> and
<em>partykit</em> packages (<span class="citation">Hothorn and Zeileis
(2015)</span>).</p>
<p><a id="ex"></a></p>
<p><br></p>
</div>
</div>
<div id="examples" class="section level1">
<h1>Examples</h1>
<p><code>shapr</code> supports computation of Shapley values with any
predictive model which takes a set of numeric features and produces a
numeric outcome. Note that the ctree method takes both numeric and
categorical variables. Check under “Advanced usage” for an example of
how this can be done.</p>
<p>The following example shows how a simple <code>xgboost</code> model
is trained using the Boston Housing Data, and how <code>shapr</code> can
be used to explain the individual predictions. Note that the empirical
conditional distribution approach is the default
(i.e. <code>approach = &quot;empirical&quot;</code>), and that the Gaussian,
Gaussian copula, and ctree approaches can be used instead by setting the
argument <code>approach</code> to either <code>&quot;gaussian&quot;</code>,
<code>&quot;copula&quot;</code>, or <code>&quot;ctree</code>“.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shapr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Boston&quot;</span>, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>x_var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lstat&quot;</span>, <span class="st">&quot;rm&quot;</span>, <span class="st">&quot;dis&quot;</span>, <span class="st">&quot;indus&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>y_var <span class="ot">&lt;-</span> <span class="st">&quot;medv&quot;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>x_train <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Boston[<span class="sc">-</span><span class="dv">1</span><span class="sc">:-</span><span class="dv">6</span>, x_var])</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> Boston[<span class="sc">-</span><span class="dv">1</span><span class="sc">:-</span><span class="dv">6</span>, y_var]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Boston[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, x_var])</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a basic xgboost model to the training data</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">xgboost</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> x_train,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> y_train,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">nround =</span> <span class="dv">20</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data for explanation</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>explainer <span class="ot">&lt;-</span> <span class="fu">shapr</span>(x_train, model)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The specified model provides feature classes that are NA. The classes of data are taken as the truth.</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifying the phi_0, i.e. the expected prediction without any features</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(y_train)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing the actual Shapley values with kernelSHAP accounting for feature dependence using</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># the empirical (conditional) distribution approach with bandwidth parameter sigma = 0.1 (default)</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>explanation <span class="ot">&lt;-</span> <span class="fu">explain</span>(</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  x_test,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">approach =</span> <span class="st">&quot;empirical&quot;</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">explainer =</span> explainer,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">prediction_zero =</span> p</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the Shapley values for the test data.</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># For more information about the interpretation of the values in the table, see ?shapr::explain.</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(explanation<span class="sc">$</span>dt)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      none     lstat         rm       dis      indus</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: 22.446 5.2632030 -1.2526613 0.2920444  4.5528644</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: 22.446 0.1671901 -0.7088401 0.9689005  0.3786871</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3: 22.446 5.9888022  5.5450858 0.5660134 -1.4304351</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4: 22.446 8.2142204  0.7507572 0.1893366  1.8298304</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5: 22.446 0.5059898  5.6875103 0.8432238  2.2471150</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6: 22.446 1.9929673 -3.6001958 0.8601984  3.1510531</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resulting explanations for observations 1 and 6</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(explanation, <span class="at">plot_phi0 =</span> <span class="cn">FALSE</span>, <span class="at">index_x_test =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The Gaussian approach is used as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the Gaussian approach</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>explanation_gaussian <span class="ot">&lt;-</span> <span class="fu">explain</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  x_test,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">approach =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">explainer =</span> explainer,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prediction_zero =</span> p</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resulting explanations for observations 1 and 6</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(explanation_gaussian, <span class="at">plot_phi0 =</span> <span class="cn">FALSE</span>, <span class="at">index_x_test =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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n17fiPd/65On39qml6K77nrdNY8FlbhbRzsb8YFyjMwkj/dXAKgRoPxmfnqd/cNGxuUN/i6X6o13OKBHVz+JGZ385W2Vxkuvu+axoBJ381a+8c6ln9z+/vLyNWbotey51K3UTG0g0AoHoAVAyTx2M9M7NjKyF2Ecc5mJW3l6+we3dEDTEfSXmSrraKKueSyouslHVzbY7M2MvLIS5y08uvpPaopPzJQjaM5Ch4D2QGaAfmtbvqMXhmthit+/JtegfIpnRrNBNpnhMYKmVjL6tvlf6Wl6jsFLd7dm5tGVZFGKEXQmoLTleWlbALpDs30eUOastkn6xu3to9e344NLmOJrACqmnqyZaSKtcABadJWJLeBpLL2+UTbF7/N3alXFhlha7pe6667XXfNYUIm7lYCmFj59Vzmmm7mzAUANACXcBKB8OH19++zHTHzxuRJjBDUDVNNOMsULM8+8xwFo0VU+rzPbLn3Abu/ffGeD3pUAKjf8tPhkL6ULKHe97prHgkrcrQOoeDQibn1+t++fYSEAdS4vve6ax4JK3PViIQD16a67XnfNY0El7nqxEID6dNddr7vmsaASd71YCEB9uuuu113zWFCJu14sBKA+3XXX6655LKjEXS8WAlCf7rrrddc8FlTirhcLAahPd931umseCypx14uFANSnu+563TWPBZW468VCAOrTXXe97prHgkrc9WIhAPXpbre9bqseWGhdj+o4APVRDyy0rkd1HID6qAcWWtejOt5fQLteZ5q4OwgLXTQFgDpSTXcHYaGLpgBQR6rp7iAsdNEUAOpINd0dhIUumgJAHammu4Ow0EVTAKgj1XR3EBa6aIopoLtRtL57YW9A7rq4GADUuimGgE4ufLy6frI5GpC7Li4GALVuihmgx6vr7E88PXd3OO66uBgA1LopANSRaro7CAtdNMVwit+lKf54dTwgd11cDABq3RTTTdI0YpJ8ZoMzqGAsZ4gHvePvkqiWWv761s0XoEYRLCmgiHROmdkPC100xf4x02xAedC717elpzwm28FcBrCt6W4dQJMoN4mZPbHQRVPMAD3ZXM+6SiEB6V5+ep3CifCwNypYaNbcgxXdYR6L5KV/7sXt7+JiGAFaFWKVoo1kzeyLhS6aYrxJygF65RoPEbTDXpYVoDJYaJyJDxrrkdjEWTlEzFd80GZNNQmxyohNvVRx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" /><!-- --></p>
<p>The Gaussian copula approach is used as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the Gaussian copula approach</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>explanation_copula <span class="ot">&lt;-</span> <span class="fu">explain</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  x_test,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">approach =</span> <span class="st">&quot;copula&quot;</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">explainer =</span> explainer,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prediction_zero =</span> p</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resulting explanations for observations 1 and 6, excluding</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># the no-covariate effect</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(explanation_copula, <span class="at">plot_phi0 =</span> <span class="cn">FALSE</span>, <span class="at">index_x_test =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The conditional inference tree approach is used as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the conditional inference tree approach</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>explanation_ctree <span class="ot">&lt;-</span> <span class="fu">explain</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  x_test,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">approach =</span> <span class="st">&quot;ctree&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">explainer =</span> explainer,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prediction_zero =</span> p</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resulting explanations for observations 1 and 6, excluding </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># the no-covariate effect</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(explanation_ctree, <span class="at">plot_phi0 =</span> <span class="cn">FALSE</span>, <span class="at">index_x_test =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can use mixed (i.e continuous, categorical, ordinal) data with
ctree. Use ctree with categorical data in the following manner:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x_var_cat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lstat&quot;</span>, <span class="st">&quot;chas&quot;</span>, <span class="st">&quot;rad&quot;</span>, <span class="st">&quot;indus&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>y_var <span class="ot">&lt;-</span> <span class="st">&quot;medv&quot;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to factors</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>Boston<span class="sc">$</span>rad <span class="ot">=</span> <span class="fu">as.factor</span>(Boston<span class="sc">$</span>rad)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Boston<span class="sc">$</span>chas <span class="ot">=</span> <span class="fu">as.factor</span>(Boston<span class="sc">$</span>chas)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>x_train_cat <span class="ot">&lt;-</span> Boston[<span class="sc">-</span><span class="dv">1</span><span class="sc">:-</span><span class="dv">6</span>, x_var_cat]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> Boston[<span class="sc">-</span><span class="dv">1</span><span class="sc">:-</span><span class="dv">6</span>, y_var]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>x_test_cat <span class="ot">&lt;-</span> Boston[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, x_var_cat]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># -- special function when using categorical data + xgboost</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>dummylist <span class="ot">&lt;-</span> <span class="fu">make_dummies</span>(<span class="at">traindata =</span> x_train_cat, <span class="at">testdata =</span> x_test_cat)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>x_train_dummy <span class="ot">&lt;-</span> dummylist<span class="sc">$</span>train_dummies</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>x_test_dummy <span class="ot">&lt;-</span> dummylist<span class="sc">$</span>test_dummies</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a basic xgboost model to the training data</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>model_cat <span class="ot">&lt;-</span> xgboost<span class="sc">::</span><span class="fu">xgboost</span>(</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> x_train_dummy,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> y_train,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">nround =</span> <span class="dv">20</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>model_cat<span class="sc">$</span>feature_list <span class="ot">&lt;-</span> dummylist<span class="sc">$</span>feature_list</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>explainer_cat <span class="ot">&lt;-</span> <span class="fu">shapr</span>(dummylist<span class="sc">$</span>traindata_new, model_cat)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(y_train)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>explanation_cat <span class="ot">&lt;-</span> <span class="fu">explain</span>(</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  dummylist<span class="sc">$</span>testdata_new,</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">approach =</span> <span class="st">&quot;ctree&quot;</span>,</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">explainer =</span> explainer_cat,</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">prediction_zero =</span> p</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resulting explanations for observations 1 and 6, excluding</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="co"># the no-covariate effect</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(explanation_cat, <span class="at">plot_phi0 =</span> <span class="cn">FALSE</span>, <span class="at">index_x_test =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can specify parameters used to build the conditional inference
trees using the following manner. Default values are based on <span class="citation">Hothorn, Hornik, and Zeileis (2006)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the conditional inference tree approach</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We can specify parameters used to building trees by specifying mincriterion, </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># minsplit, minbucket</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>explanation_ctree <span class="ot">&lt;-</span> <span class="fu">explain</span>(</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  x_test,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">approach =</span> <span class="st">&quot;ctree&quot;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">explainer =</span> explainer,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">prediction_zero =</span> p,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">mincriterion =</span> <span class="fl">0.80</span>, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">minsplit =</span> <span class="dv">20</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">minbucket =</span> <span class="dv">20</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Default parameters (based on (Hothorn, 2006)) are:</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># mincriterion = 0.95</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># minsplit = 20</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># minbucket = 7</span></span></code></pre></div>
<p>We can also specify multiple different mincriterion (1 minus the
boundary for when to stop splitting nodes) parameters to use when
conditioning on different numbers of features. In this case, a vector of
length = number of features must be provided.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the conditional inference tree approach</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify a vector of mincriterions instead of just one</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># In this case, when conditioning on 1 or 2 features, use mincriterion = 0.25</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># When conditioning on 3 or 4 features, use mincriterion = 0.95</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>explanation_ctree <span class="ot">&lt;-</span> <span class="fu">explain</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  x_test,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">approach =</span> <span class="st">&quot;ctree&quot;</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">explainer =</span> explainer,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">prediction_zero =</span> p,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">mincriterion =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.95</span>, <span class="fl">0.95</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="main-arguments-in-shapr" class="section level2">
<h2>Main arguments in <code>shapr</code></h2>
<p>When using <code>shapr</code>, the default behavior is to use all
feature combinations in the Shapley formula. Kernel SHAP’s sampling
based approach may be used by specifying <code>n_combinations</code>,
which is the number of feature combinations to sample. If not specified,
the exact method is used. The computation time grows approximately
exponentially with the number of samples. The training data and the
model whose predictions we wish to explain must be provided through the
arguments <code>x</code> and <code>model</code>. Note that
<code>x</code> must be a <code>data.frame</code> or a
<code>matrix</code>, and all elements must be finite numerical values.
Currently we do not support categorical features or missing values.</p>
</div>
<div id="main-arguments-in-explain" class="section level2">
<h2>Main arguments in <code>explain</code></h2>
<p>The test data given by <code>x</code>, whose predicted values we wish
to explain, must be provided. Note that <code>x</code> must be a
<code>data.frame</code> or a <code>matrix,</code> where all elements are
finite numerical values. One must also provide the object returned by
<code>shapr</code> through the argument <code>explainer</code>. The
default approach when computing the Shapley values is the empirical
approach (i.e. <code>approach = &quot;empirical&quot;</code>). If you’d like to
use a different approach you’ll need to set <code>approach</code> equal
to either <code>copula</code> or <code>gaussian</code>, or a vector of
them, with length equal to the number of features. If a vector, a
combined approach is used, and element <code>i</code> indicates the
approach to use when conditioning on <code>i</code> variables. For more
details see <a href="#combined">Combined approach</a> below.</p>
<p>When computing the kernel SHAP values by <code>explain</code>, the
maximum number of samples to use in the Monte Carlo integration for
every conditional expectation is controlled by the argument
<code>n_samples</code> (default equals <code>1000</code>). The
computation time grows approximately linear with this number. You will
also need to pass a numeric value for the argument
<code>prediction_zero</code>, which represents the prediction value when
not conditioning on any features. We recommend setting this equal to the
mean of the response, but other values, like the mean prediction of a
large test data set is also a possibility. If the empirical method is
used, specific settings for that approach, like a vector of fixed <span class="math inline">\(\sigma\)</span> values can be specified through
the argument <code>sigma_vec</code>. See <code>?explain</code> for more
information. If <code>approach = &quot;gaussian&quot;</code>, you may specify the
mean vector and covariance matrix of the data generating distribution by
the arguments <code>mu</code> and <code>cov_mat</code>. If not
specified, they are estimated from the training data.</p>
<p><a id="advanced"></a></p>
<p><br></p>
</div>
</div>
<div id="advanced-usage" class="section level1">
<h1>Advanced usage</h1>
<p><a id="combined"></a></p>
<div id="combined-approach" class="section level2">
<h2>Combined approach</h2>
<p>In addition to letting the user select one of the three
aforementioned approaches for estimating the conditional distribution of
the data (i.e. <code>approach</code> equals either <a href="#gaussian"><code>&quot;gaussian&quot;</code></a>, <a href="#copula"><code>&quot;copula&quot;</code></a>, <a href="#empirical"><code>&quot;empirical&quot;</code></a> or <a href="#ctree"><code>&quot;ctree&quot;</code></a>) the package allows the user to
combine the four approaches. To simplify the usage, the flexibility is
restricted such that the same approach is used when conditioning on the
same number of features. This is also in line <span class="citation">Aas, Jullum, and Løland (2019, sec. 3.4)</span>.</p>
<p>This can be done by setting <code>approach</code> equal to a
character vector, where the length of the vector is equal to the number
of features in the model. Consider a situation where you have trained a
model that consists of 10 features, and you would like to use the
<code>&quot;empirical&quot;</code> approach when you condition on 1-3 features,
the <code>&quot;copula&quot;</code> approach when you condition on 4-5 features,
and the <code>&quot;gaussian&quot;</code> approach when conditioning on 6 or more
features. This can be applied by simply passing
<code>approach = c(rep(&quot;empirical&quot;, 3), rep(&quot;copula&quot;, 2), rep(&quot;gaussian&quot;, 5))</code>,
i.e. <code>approach[i]</code> determines which method to use when
conditioning on <code>i</code> features.</p>
<p>The code below exemplifies this approach for a case where there are
four features, using <code>&quot;empirical&quot;, &quot;copula&quot;</code> and
<code>&quot;gaussian&quot;</code> when conditioning on respectively 1, 2 and 3-4
features. Note that it does not matter what method that is specified
when conditioning on all features, as that equals the actual prediction
regardless of the specified approach.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the combined approach</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>explanation_combined <span class="ot">&lt;-</span> <span class="fu">explain</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  x_test,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">approach =</span> <span class="fu">c</span>(<span class="st">&quot;empirical&quot;</span>, <span class="st">&quot;copula&quot;</span>, <span class="st">&quot;gaussian&quot;</span>, <span class="st">&quot;gaussian&quot;</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">explainer =</span> explainer,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prediction_zero =</span> p</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resulting explanations for observations 1 and 6, excluding</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># the no-covariate effect</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(explanation_combined, <span class="at">plot_phi0 =</span> <span class="cn">FALSE</span>, <span class="at">index_x_test =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As a second example using <code>&quot;ctree&quot;</code> for the first 3
features and <code>&quot;empirical&quot;</code> for the last:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the combined approach</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>explanation_combined <span class="ot">&lt;-</span> <span class="fu">explain</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  x_test,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">approach =</span> <span class="fu">c</span>(<span class="st">&quot;ctree&quot;</span>, <span class="st">&quot;ctree&quot;</span>, <span class="st">&quot;ctree&quot;</span>, <span class="st">&quot;empirical&quot;</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">explainer =</span> explainer,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prediction_zero =</span> p</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="using-ctree-when-features-are-mixed-numerical-and-categorical" class="section level2">
<h2>Using ctree when features are mixed numerical and categorical</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x_var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lstat&quot;</span>, <span class="st">&quot;rm&quot;</span>, <span class="st">&quot;dis&quot;</span>, <span class="st">&quot;indus&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y_var <span class="ot">&lt;-</span> <span class="st">&quot;medv&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert two features as factors</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> Boston[, <span class="fu">c</span>(x_var, y_var)]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>rm <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">round</span>(dt<span class="sc">$</span>rm<span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>dis <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">round</span>(dt<span class="sc">$</span>dis<span class="sc">/</span><span class="dv">4</span>))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>xy_train_cat <span class="ot">&lt;-</span> dt[<span class="sc">-</span><span class="dv">1</span><span class="sc">:-</span><span class="dv">6</span>, ]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>y_train_cat <span class="ot">&lt;-</span> dt[<span class="sc">-</span><span class="dv">1</span><span class="sc">:-</span><span class="dv">6</span>, y_var]</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>x_train_cat <span class="ot">&lt;-</span> dt[<span class="sc">-</span><span class="dv">1</span><span class="sc">:-</span><span class="dv">6</span>, x_var]</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>x_test_cat <span class="ot">&lt;-</span> dt[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, x_var]</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a basic linear regression model to the training data</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> lstat <span class="sc">+</span> rm <span class="sc">+</span> dis <span class="sc">+</span> indus, <span class="at">data =</span> xy_train_cat)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data for explanation</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>explainer <span class="ot">&lt;-</span> <span class="fu">shapr</span>(x_train_cat, model)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifying the phi_0, i.e. the expected prediction without any features</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(y_train_cat)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing the actual Shapley values with kernelSHAP accounting for feature dependence using</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>explanation_categorical <span class="ot">&lt;-</span> <span class="fu">explain</span>(</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  x_test_cat,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">approach =</span> <span class="st">&quot;ctree&quot;</span>,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">explainer =</span> explainer,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">prediction_zero =</span> p</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that nothing has to be specified to tell &quot;ctree&quot; that two of the features are </span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co"># cateogrical and two are numerical</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resulting explanations for observations 1 and 6, excluding </span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co"># the no-covariate effect</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(explanation_categorical, <span class="at">plot_phi0 =</span> <span class="cn">FALSE</span>, <span class="at">index_x_test =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="explain-custom-models" class="section level2">
<h2>Explain custom models</h2>
<p><code>shapr</code> currently natively supports explanation of
predictions from models fitted with the following functions:</p>
<ul>
<li><code>stats::lm</code></li>
<li><code>stats::glm</code></li>
<li><code>ranger::ranger</code></li>
<li><code>mgcv::gam</code></li>
<li><code>xgboost::xgboost</code>/<code>xgboost::xgb.train</code></li>
</ul>
<p>Any continuous response regression model or binary classification
model of these model classes, can be explained with the package directly
as exemplified above. Moreover, essentially any feature dependent
prediction model can be explained by the package by specifying two (or
one) simple additional functions to the class your model belongs to.</p>
<p><em>Note: The below procedure for specifying custom models was
changed in shapr v0.2.0</em> The first class function is
<code>predict_model</code>, taking the model and data (as a
<code>matrix</code> or <code>data.frame/data.table</code>) as input and
outputting the corresponding prediction as a numeric vector. The second
(optional, but highly recommended) class function is
<code>get_model_specs</code>, taking the model as input and outputting a
list with the following elements: <em>labels</em> (vector with the
feature names to compute Shapley values for), <em>classes</em> (a named
vector with the labels as names and the class type as elements),
<em>factor_levels</em> (a named list with the labels as names and
vectors with the factor levels as elements (NULL if the feature is not a
factor)). The <code>get_model_specs</code> function is used to check
that the format of the data passed to <code>shapr</code> and
<code>explain</code> have the correct format in terms of the necessary
feature columns being available and having the correct class/attributes.
It is highly recommended to do such checks in order to ensure correct
usage of <code>shapr</code> and <code>explain</code>. If, for some
reason, such checking is not desirable, one does not have to provide the
<code>get_model_specs</code> function class. This will, however, throw a
warning that all feature consistency checking against the model is
disabled.</p>
<p>Once the above class functions are created, one can explain
predictions from this model class as before. These functions
<strong>can</strong> be made general enough to handle all supported
model types of that class, or they can be made minimal, possibly only
allowing explanation of the specific version of the model class at hand.
Below we give examples of both full support versions of these functions
and a minimal version which skips the <code>get_model_specs</code>
function. We do this for the <code>gbm</code> model class from the
<code>gbm</code> package, fitted to the same Boston data set as used
above.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gbm)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loaded gbm 2.1.8.1</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>xy_train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x_train,<span class="at">medv =</span> y_train)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>form <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste0</span>(y_var,<span class="st">&quot;~&quot;</span>,<span class="fu">paste0</span>(x_var,<span class="at">collapse=</span><span class="st">&quot;+&quot;</span>)))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a gbm model</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">825</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> gbm<span class="sc">::</span><span class="fu">gbm</span>(</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  form,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> xy_train,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="do">#### Full feature versions of the three required model functions ####</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>predict_model.gbm <span class="ot">&lt;-</span> <span class="cf">function</span>(x, newdata) {</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&#39;gbm&#39;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&#39;The gbm package is required for predicting train models&#39;</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  model_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span>distribution<span class="sc">$</span>name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;bernoulli&quot;</span>,<span class="st">&quot;adaboost&quot;</span>),</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;classification&quot;</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;regression&quot;</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (model_type <span class="sc">==</span> <span class="st">&quot;classification&quot;</span>) {</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(x, <span class="fu">as.data.frame</span>(newdata), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>,<span class="at">n.trees =</span> x<span class="sc">$</span>n.trees)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(x, <span class="fu">as.data.frame</span>(newdata),<span class="at">n.trees =</span> x<span class="sc">$</span>n.trees)</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>get_model_specs.gbm <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  feature_list <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  feature_list<span class="sc">$</span>labels <span class="ot">&lt;-</span> <span class="fu">labels</span>(x<span class="sc">$</span>Terms)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(feature_list<span class="sc">$</span>labels)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  feature_list<span class="sc">$</span>classes <span class="ot">&lt;-</span> <span class="fu">attr</span>(x<span class="sc">$</span>Terms,<span class="st">&quot;dataClasses&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  feature_list<span class="sc">$</span>factor_levels <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, m), feature_list<span class="sc">$</span>labels)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  feature_list<span class="sc">$</span>factor_levels[feature_list<span class="sc">$</span>classes<span class="sc">==</span><span class="st">&quot;factor&quot;</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># the model object doesn&#39;t contain factor levels info</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(feature_list)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data for explanation</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>explainer <span class="ot">&lt;-</span> <span class="fu">shapr</span>(xy_train, model)</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The columns(s) medv is not used by the model and thus removed from the data.</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(xy_train[,y_var])</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>explanation <span class="ot">&lt;-</span> <span class="fu">explain</span>(x_test, explainer, <span class="at">approach =</span> <span class="st">&quot;empirical&quot;</span>, <span class="at">prediction_zero =</span> p0)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot results</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(explanation)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="do">#### Minimal version of the three required model functions ####      </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Working only for this exact version of the model class </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Avoiding to define get_model_specs skips all feature         </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># consistency checking between your data and model             </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing the previously defined functions to simulate a fresh start</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(predict_model.gbm)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(get_model_specs.gbm)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>predict_model.gbm <span class="ot">&lt;-</span> <span class="cf">function</span>(x, newdata) {</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(x, <span class="fu">as.data.frame</span>(newdata),<span class="at">n.trees =</span> x<span class="sc">$</span>n.trees)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data for explanation</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>explainer <span class="ot">&lt;-</span> <span class="fu">shapr</span>(x_train, model)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; get_model_specs is not available for your custom model. All feature consistency checking between model and data is disabled.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; See the &#39;Advanced usage&#39; section of the vignette:</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; vignette(&#39;understanding_shapr&#39;, package = &#39;shapr&#39;)</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; for more information.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The specified model provides feature labels that are NA. The labels of data are taken as the truth.</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(xy_train[,y_var])</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>explanation <span class="ot">&lt;-</span> <span class="fu">explain</span>(x_test, explainer, <span class="at">approach =</span> <span class="st">&quot;empirical&quot;</span>, <span class="at">prediction_zero =</span> p0)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot results</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(explanation)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><a id="compare"></a></p>
<p><br></p>
</div>
</div>
<div id="comparison-to-lundberg-lees-implementation" class="section level1">
<h1>Comparison to Lundberg &amp; Lee’s implementation</h1>
<p>As mentioned above, the original (independence assuming) Kernel SHAP
implementation can be approximated by setting a large <span class="math inline">\(\sigma\)</span> value using our empirical
approach. If we specify that the distances to <em>all</em> training
observations should be used (i.e. setting
<code>approach = &quot;empirical&quot;</code> and <code>w_threshold = 1</code>
when using <code>explain</code>, we can approximate the original method
arbitrarily well by increasing <span class="math inline">\(\sigma\)</span>. For completeness of the
<code>shapr</code>, we have also implemented a version of the original
method, which samples training observations independently with respect
to their distances to test observations (i.e. without the large-<span class="math inline">\(\sigma\)</span> approximation). This method is
available by using <code>approach = &quot;empirical&quot;</code> and
<code>type = &quot;independence&quot;</code> in <code>explain</code>.</p>
<p>We have compared the results using these two variants with the
original implementation of <span class="citation">Lundberg and Lee
(2017)</span>, available through the Python library <a href="https://github.com/slundberg/shap"><code>shap</code></a>. As
above, we used the Boston housing data, trained via
<code>xgboost</code>. We specify that <em>all</em> training observations
should be used when explaining all of the 6 test observations. To run
the individual explanation method in the <code>shap</code> Python
library we use the <code>reticulate</code> <code>R</code>-package,
allowing Python code to run within <code>R</code>. As this requires
installation of Python package, the comparison code and results is not
included in this vignette, but can be found <a href="https://github.com/NorskRegnesentral/shapr/blob/master/inst/scripts/compare_shap_python.R">here</a>.
As indicated by the (commented out) results in the file above both
methods in our <code>R</code>-package give (up to numerical
approximation error) identical results to the original implementation in
the Python <code>shap</code> library.</p>
<p><br></p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-aas2019explaining" class="csl-entry">
Aas, Kjersti, Martin Jullum, and Anders Løland. 2019. <span>“Explaining
Individual Predictions When Features Are Dependent: More Accurate
Approximations to Shapley Values.”</span> <em>arXiv Preprint
arXiv:1903.10464</em>.
</div>
<div id="ref-hothorn2006unbiased" class="csl-entry">
Hothorn, Torsten, Kurt Hornik, and Achim Zeileis. 2006. <span>“Unbiased
Recursive Partitioning: A Conditional Inference Framework.”</span>
<em>Journal of Computational and Graphical Statistics</em> 15 (3):
651–74.
</div>
<div id="ref-partykit_package" class="csl-entry">
Hothorn, Torsten, and Achim Zeileis. 2015. <span>“<span class="nocase">partykit</span>: A Modular Toolkit for Recursive
Partytioning in <span>R</span>.”</span> <em>Journal of Machine Learning
Research</em> 16: 3905–9.
</div>
<div id="ref-lundberg2017unified" class="csl-entry">
Lundberg, Scott M, and Su-In Lee. 2017. <span>“A Unified Approach to
Interpreting Model Predictions.”</span> In <em>Advances in Neural
Information Processing Systems</em>, 4765–74.
</div>
<div id="ref-Redelmeier2020ctree" class="csl-entry">
Redelmeier, Annabelle, Martin Jullum, and Kjersti Aas. 2020.
<span>“Explaining Predictive Models with Mixed Features Using Shapley
Values and Conditional Inference Trees.”</span> <em>Submitted</em>.
</div>
<div id="ref-rosenblatt1956" class="csl-entry">
Rosenblatt, Murray. 1956. <span>“<span class="nocase">Remarks on Some
Nonparametric Estimates of a Density Function</span>.”</span>
<em><span>The Annals of Mathematical Statistics</span></em> 27: 832–37.
</div>
<div id="ref-Shapley53" class="csl-entry">
Shapley, Lloyd S. 1953. <span>“<span class="nocase">A Value for N-Person
Games</span>.”</span> <em><span>Contributions to the Theory of
Games</span></em> 2: 307–17.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
